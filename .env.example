# =============================================================================
# KAFAAT 1.0 - UAE MOE TALENT MANAGEMENT SYSTEM
# Environment Variables Template
# =============================================================================
# Copy this file to .env and fill in the values for your environment.
# DO NOT commit .env to version control!
# =============================================================================

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
DATABASE_URL=mysql://user:password@localhost:3306/kafaat_tms

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
NODE_ENV=development
PORT=5000
SESSION_SECRET=your-session-secret-min-32-chars

# =============================================================================
# AZURE AD / ENTRA ID CONFIGURATION (Multi-Tenant SSO)
# =============================================================================
# Register your app at https://portal.azure.com > Azure Active Directory > App registrations

# Application (client) ID from Azure AD app registration
AZURE_AD_CLIENT_ID=

# Client secret from Azure AD app registration > Certificates & secrets
AZURE_AD_CLIENT_SECRET=

# For multi-tenant apps, use "common" or "organizations"
# For single-tenant, use your Azure AD tenant ID (GUID)
AZURE_AD_TENANT_ID=common

# The redirect URI configured in Azure AD app registration
AZURE_AD_REDIRECT_URI=https://your-app.azurewebsites.net/api/auth/azure/callback

# =============================================================================
# AZURE MARKETPLACE CONFIGURATION (SaaS Fulfillment API v2)
# =============================================================================
# Configure these after creating your offer in Partner Center

# Your Publisher ID from Partner Center
AZURE_MARKETPLACE_PUBLISHER_ID=

# The Offer ID for this SaaS offer
AZURE_MARKETPLACE_OFFER_ID=kafaat-talent-management

# Your organization's Azure AD tenant ID (for marketplace auth)
AZURE_MARKETPLACE_TENANT_ID=

# Client ID for marketplace API authentication (same as AZURE_AD_CLIENT_ID usually)
AZURE_MARKETPLACE_CLIENT_ID=

# Client secret for marketplace API authentication
AZURE_MARKETPLACE_CLIENT_SECRET=

# Webhook secret for validating marketplace webhook calls (optional but recommended)
AZURE_MARKETPLACE_WEBHOOK_SECRET=

# Landing page URL for subscription resolution
AZURE_MARKETPLACE_LANDING_URL=https://your-app.azurewebsites.net/api/marketplace/landing

# Webhook URL for subscription lifecycle events
AZURE_MARKETPLACE_WEBHOOK_URL=https://your-app.azurewebsites.net/api/marketplace/webhook

# =============================================================================
# TDRA COMPLIANCE CONFIGURATION (UAE Data Protection)
# =============================================================================
# These settings control TDRA-aligned data residency and compliance features

# Enable TDRA compliance mode (true/false)
TDRA_COMPLIANCE_ENABLED=true

# Allowed data residency regions (comma-separated)
# UAE: ae-north-1, ae-south-1
TDRA_ALLOWED_REGIONS=ae-north-1,ae-south-1

# Primary data region for new tenants
TDRA_PRIMARY_REGION=ae-north-1

# Consent retention period in days (TDRA recommends 7 years = 2555 days)
TDRA_CONSENT_RETENTION_DAYS=2555

# Enable data masking for cross-border API calls
TDRA_ENABLE_DATA_MASKING=true

# Audit log retention period in days (TDRA recommends 5 years = 1825 days)
TDRA_AUDIT_RETENTION_DAYS=1825

# =============================================================================
# AI SERVICES CONFIGURATION (Hybrid Multi-Provider)
# =============================================================================
# Cost-optimized AI with automatic provider selection:
# - Template service (60% - free, rule-based)
# - Together.ai (35% - free tier 5M tokens/mo)
# - OpenAI (5% - paid, critical quality)

# ─────────────────────────────────────────────────────────────────────────────
# TOGETHER.AI (Primary - Free Tier: 5M tokens/month)
# ─────────────────────────────────────────────────────────────────────────────
# Sign up at https://api.together.xyz/signup
# Use for: Resume parsing, interview questions, licensing questions, competency analysis

TOGETHER_API_KEY=
TOGETHER_MODEL=meta-llama/Llama-3.2-3B-Instruct-Turbo
TOGETHER_BASE_URL=https://api.together.xyz/v1
TOGETHER_TIMEOUT=30000

# ─────────────────────────────────────────────────────────────────────────────
# OPENAI (Secondary - Pay-as-you-go for critical features)
# ─────────────────────────────────────────────────────────────────────────────
# Use for: Psychometric assessments (requires high quality)
# Estimated cost: $5-10/month for testing, $50-100/month for production

OPENAI_API_KEY=

# ─────────────────────────────────────────────────────────────────────────────
# AZURE OPENAI (Alternative to OpenAI - Preferred for UAE/Enterprise)
# ─────────────────────────────────────────────────────────────────────────────

AZURE_OPENAI_ENDPOINT=https://your-instance.openai.azure.com
AZURE_OPENAI_API_KEY=
AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4o-mini

# ─────────────────────────────────────────────────────────────────────────────
# AI PROVIDER CONFIGURATION
# ─────────────────────────────────────────────────────────────────────────────
# Leave empty for automatic selection based on ai-config.ts
# Override specific features if needed:
#   AI_PROVIDER_RESUME_PARSING=together
#   AI_PROVIDER_CAREER_RECOMMENDATIONS=template
#   AI_PROVIDER_PSYCHOMETRIC=openai

# =============================================================================
# AZURE STORAGE CONFIGURATION
# =============================================================================
# For document storage (resumes, certificates, etc.)

AZURE_STORAGE_CONNECTION_STRING=
AZURE_STORAGE_CONTAINER_NAME=kafaat-documents

# =============================================================================
# AZURE KEY VAULT (OPTIONAL - RECOMMENDED FOR PRODUCTION)
# =============================================================================
# When configured, secrets are fetched from Key Vault instead of env vars

AZURE_KEY_VAULT_URL=https://your-keyvault.vault.azure.net

# =============================================================================
# EMAIL CONFIGURATION
# =============================================================================
# For notifications and alerts

SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASSWORD=your-sendgrid-api-key
EMAIL_FROM=noreply@kafaat.ae

# =============================================================================
# BLOCKCHAIN VERIFICATION (OPTIONAL)
# =============================================================================
# For certificate/license verification on blockchain

BLOCKCHAIN_ENABLED=false
BLOCKCHAIN_NETWORK=ethereum
BLOCKCHAIN_RPC_URL=
BLOCKCHAIN_PRIVATE_KEY=
BLOCKCHAIN_CONTRACT_ADDRESS=

# =============================================================================
# FEATURE FLAGS
# =============================================================================
# Enable/disable features for gradual rollout

FEATURE_AI_RECOMMENDATIONS=true
FEATURE_PSYCHOMETRIC_ASSESSMENTS=true
FEATURE_BLOCKCHAIN_VERIFICATION=false
FEATURE_MULTI_TENANCY=true
FEATURE_MARKETPLACE_INTEGRATION=true

# =============================================================================
# LOGGING & MONITORING
# =============================================================================
# Azure Application Insights

APPLICATIONINSIGHTS_CONNECTION_STRING=

# Log level (debug, info, warn, error)
LOG_LEVEL=info

# =============================================================================
# RATE LIMITING
# =============================================================================
# API rate limiting configuration

RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# CORS CONFIGURATION
# =============================================================================
# Allowed origins for cross-origin requests

CORS_ALLOWED_ORIGINS=https://your-app.azurewebsites.net,http://localhost:5173

# =============================================================================
# END OF CONFIGURATION
# =============================================================================
